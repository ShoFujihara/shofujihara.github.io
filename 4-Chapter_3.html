<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 第3章 | 『カテゴリカルデータの連関モデル』サポートページ</title>
  <meta name="description" content="3 第3章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 第3章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 第3章 | 『カテゴリカルデータの連関モデル』サポートページ" />
  
  
  

<meta name="author" content="藤原翔（Sho Fujihara）" />


<meta name="date" content="2021-06-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="3-Chapter_2.html"/>

<script src="libs/header-attrs-2.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">『カテゴリカルデータの連関モデル』サポートページ</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="1-Introduction.html"><a href="1-Introduction.html"><i class="fa fa-check"></i>はじめに</a>
<ul>
<li class="chapter" data-level="" data-path="1-Introduction.html"><a href="1-Introduction.html#本ページの目的"><i class="fa fa-check"></i>本ページの目的</a></li>
<li class="chapter" data-level="" data-path="1-Introduction.html"><a href="1-Introduction.html#正誤表"><i class="fa fa-check"></i>正誤表</a></li>
<li class="chapter" data-level="" data-path="1-Introduction.html"><a href="1-Introduction.html#rのインストール"><i class="fa fa-check"></i>Rのインストール</a></li>
<li><a href="1-Introduction.html#l_rm-emのインストール"><span class="math inline">\(l_{\rm EM}\)</span>のインストール</a></li>
<li class="chapter" data-level="" data-path="1-Introduction.html"><a href="1-Introduction.html#シリーズ編者による序文"><i class="fa fa-check"></i>シリーズ編者による序文</a>
<ul>
<li class="chapter" data-level="" data-path="1-Introduction.html"><a href="1-Introduction.html#独立性の検定"><i class="fa fa-check"></i>独立性の検定</a></li>
<li class="chapter" data-level="" data-path="1-Introduction.html"><a href="1-Introduction.html#一様連関モデル"><i class="fa fa-check"></i>一様連関モデル</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="1-Introduction.html"><a href="1-Introduction.html#度数行変数列変数のデータからクロス表を作成"><i class="fa fa-check"></i>度数，行変数，列変数のデータからクロス表を作成</a></li>
<li class="chapter" data-level="" data-path="1-Introduction.html"><a href="1-Introduction.html#練習問題"><i class="fa fa-check"></i>練習問題</a></li>
<li class="chapter" data-level="" data-path="1-Introduction.html"><a href="1-Introduction.html#参考文献"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="2-Chapter_1.html"><a href="2-Chapter_1.html"><i class="fa fa-check"></i><b>1</b> 第1章</a></li>
<li class="chapter" data-level="2" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html"><i class="fa fa-check"></i><b>2</b> 第2章</a>
<ul>
<li class="chapter" data-level="2.1" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.1-p.8"><i class="fa fa-check"></i><b>2.1</b> 表2.1 (p.8)</a></li>
<li class="chapter" data-level="2.2" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.3-p.32"><i class="fa fa-check"></i><b>2.2</b> 表2.3 (p.32)</a></li>
<li class="chapter" data-level="2.3" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.4a"><i class="fa fa-check"></i><b>2.3</b> 表2.4A</a></li>
<li class="chapter" data-level="2.4" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.4b"><i class="fa fa-check"></i><b>2.4</b> 表2.4B</a></li>
<li class="chapter" data-level="2.5" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.5a"><i class="fa fa-check"></i><b>2.5</b> 表2.5A</a></li>
<li class="chapter" data-level="2.6" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#logmultパッケージの利用"><i class="fa fa-check"></i><b>2.6</b> logmultパッケージの利用</a></li>
<li class="chapter" data-level="2.7" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6a"><i class="fa fa-check"></i><b>2.7</b> 表2.6A</a></li>
<li class="chapter" data-level="2.8" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6b"><i class="fa fa-check"></i><b>2.8</b> 表2.6B</a></li>
<li class="chapter" data-level="2.9" data-path="3-Chapter_2.html"><a href="3-Chapter_2.html#表2.6c"><i class="fa fa-check"></i><b>2.9</b> 表2.6C</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html"><i class="fa fa-check"></i><b>3</b> 第3章</a>
<ul>
<li class="chapter" data-level="3.1" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html#表3.1a"><i class="fa fa-check"></i><b>3.1</b> 表3.1A</a></li>
<li class="chapter" data-level="3.2" data-path="4-Chapter_3.html"><a href="4-Chapter_3.html#表3.1b"><i class="fa fa-check"></i><b>3.2</b> 表3.1B</a></li>
</ul></li>
<li class="divider"></li>
<li></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">『カテゴリカルデータの連関モデル』サポートページ</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第3章" class="section level1" number="3">
<h1><span class="header-section-number">3</span> 第3章</h1>
<pre><code>## [1] 1000</code></pre>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="4-Chapter_3.html#cb2-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="4-Chapter_3.html#cb2-2"></a><span class="kw">library</span>(magrittr)</span>
<span id="cb2-3"><a href="4-Chapter_3.html#cb2-3"></a><span class="kw">library</span>(gnm)</span></code></pre></div>
<div id="表3.1a" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> 表3.1A</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="4-Chapter_3.html#cb3-1"></a><span class="kw">library</span>(gnm)</span>
<span id="cb3-2"><a href="4-Chapter_3.html#cb3-2"></a></span>
<span id="cb3-3"><a href="4-Chapter_3.html#cb3-3"></a><span class="co"># 表3.1</span></span>
<span id="cb3-4"><a href="4-Chapter_3.html#cb3-4"></a>Freq &lt;-<span class="st"> </span><span class="kw">c</span>(  <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>,    <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">1</span>,    <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>,</span>
<span id="cb3-5"><a href="4-Chapter_3.html#cb3-5"></a>           <span class="dv">17</span>,<span class="dv">13</span>, <span class="dv">7</span>, <span class="dv">4</span>,   <span class="dv">13</span>,<span class="dv">22</span>, <span class="dv">9</span>, <span class="dv">1</span>,    <span class="dv">7</span>,<span class="dv">13</span>, <span class="dv">6</span>, <span class="dv">2</span>,</span>
<span id="cb3-6"><a href="4-Chapter_3.html#cb3-6"></a>            <span class="dv">8</span>,<span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">0</span>,   <span class="dv">10</span>,<span class="dv">29</span>,<span class="dv">10</span>, <span class="dv">0</span>,    <span class="dv">5</span>,<span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">2</span>,</span>
<span id="cb3-7"><a href="4-Chapter_3.html#cb3-7"></a>           <span class="dv">20</span>,<span class="dv">38</span>,<span class="dv">24</span>, <span class="dv">8</span>,   <span class="dv">23</span>,<span class="dv">72</span>,<span class="dv">34</span>,<span class="dv">10</span>,   <span class="dv">17</span>,<span class="dv">67</span>,<span class="dv">36</span>,<span class="dv">12</span>,</span>
<span id="cb3-8"><a href="4-Chapter_3.html#cb3-8"></a>            <span class="dv">4</span>,<span class="dv">21</span>,<span class="dv">12</span>, <span class="dv">4</span>,    <span class="dv">7</span>,<span class="dv">30</span>, <span class="dv">9</span>, <span class="dv">1</span>,    <span class="dv">9</span>,<span class="dv">19</span>,<span class="dv">14</span>, <span class="dv">2</span>,</span>
<span id="cb3-9"><a href="4-Chapter_3.html#cb3-9"></a>            <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">3</span>,    <span class="dv">1</span>,<span class="dv">16</span>,<span class="dv">19</span>, <span class="dv">2</span>,   <span class="dv">11</span>,<span class="dv">28</span>,<span class="dv">28</span>,<span class="dv">11</span>,</span>
<span id="cb3-10"><a href="4-Chapter_3.html#cb3-10"></a>            <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">0</span>,    <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>,    <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span></code></pre></div>
<ul>
<li>モデル適合度を表示するための関数</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="4-Chapter_3.html#cb4-1"></a>model.summary &lt;-<span class="st"> </span><span class="cf">function</span>(obj){</span>
<span id="cb4-2"><a href="4-Chapter_3.html#cb4-2"></a>  aic &lt;-<span class="st"> </span>obj<span class="op">$</span>deviance <span class="op">-</span><span class="st"> </span>obj<span class="op">$</span>df <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="co"># AIC(L2)</span></span>
<span id="cb4-3"><a href="4-Chapter_3.html#cb4-3"></a>  bic &lt;-<span class="st"> </span>obj<span class="op">$</span>deviance <span class="op">-</span><span class="st"> </span>obj<span class="op">$</span>df <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">sum</span>(obj<span class="op">$</span>y)) <span class="co">#BIC(L2)</span></span>
<span id="cb4-4"><a href="4-Chapter_3.html#cb4-4"></a>  delta &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">abs</span>(obj<span class="op">$</span>y <span class="op">-</span><span class="st"> </span>obj<span class="op">$</span>fitted.values)) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(obj<span class="op">$</span>y))</span>
<span id="cb4-5"><a href="4-Chapter_3.html#cb4-5"></a>  p &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(obj<span class="op">$</span>deviance, obj<span class="op">$</span>df, <span class="dt">lower.tail =</span> F)     <span class="co">#p&lt;-ifelse(p&lt;0.001,&quot;&lt;0.001&quot;,p)</span></span>
<span id="cb4-6"><a href="4-Chapter_3.html#cb4-6"></a>  result &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">7</span>)</span>
<span id="cb4-7"><a href="4-Chapter_3.html#cb4-7"></a>  Model &lt;-<span class="st"> </span><span class="kw">deparse</span>(<span class="kw">substitute</span>(obj))</span>
<span id="cb4-8"><a href="4-Chapter_3.html#cb4-8"></a>  result &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">&quot;Model Description&quot;</span> =<span class="st"> </span>Model,</span>
<span id="cb4-9"><a href="4-Chapter_3.html#cb4-9"></a>              <span class="st">&quot;df&quot;</span> =<span class="st"> </span>obj<span class="op">$</span>df, </span>
<span id="cb4-10"><a href="4-Chapter_3.html#cb4-10"></a>              <span class="st">&quot;L2&quot;</span> =<span class="st"> </span>obj<span class="op">$</span>deviance, </span>
<span id="cb4-11"><a href="4-Chapter_3.html#cb4-11"></a>              <span class="co">#&quot;AIC(L2)&quot; = aic, </span></span>
<span id="cb4-12"><a href="4-Chapter_3.html#cb4-12"></a>              <span class="st">&quot;BIC&quot;</span> =<span class="st"> </span>bic, </span>
<span id="cb4-13"><a href="4-Chapter_3.html#cb4-13"></a>              <span class="st">&quot;Delta&quot;</span> =<span class="st"> </span>delta, </span>
<span id="cb4-14"><a href="4-Chapter_3.html#cb4-14"></a>              <span class="st">&quot;p&quot;</span> =<span class="st"> </span>p)</span>
<span id="cb4-15"><a href="4-Chapter_3.html#cb4-15"></a>  <span class="kw">return</span>(result)</span>
<span id="cb4-16"><a href="4-Chapter_3.html#cb4-16"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="4-Chapter_3.html#cb5-1"></a>polviews &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">7</span>, <span class="dt">k =</span> <span class="dv">4</span><span class="op">*</span><span class="dv">3</span>, <span class="dt">length =</span> <span class="kw">length</span>(Freq))</span>
<span id="cb5-2"><a href="4-Chapter_3.html#cb5-2"></a>fefam &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">length =</span> <span class="kw">length</span>(Freq))</span>
<span id="cb5-3"><a href="4-Chapter_3.html#cb5-3"></a>natfare &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="dv">4</span>, <span class="dt">length =</span> <span class="kw">length</span>(Freq))</span>
<span id="cb5-4"><a href="4-Chapter_3.html#cb5-4"></a></span>
<span id="cb5-5"><a href="4-Chapter_3.html#cb5-5"></a>tab_<span class="fl">3.1</span> &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>natfare)</span>
<span id="cb5-6"><a href="4-Chapter_3.html#cb5-6"></a>freq_tab_<span class="fl">3.1</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(Freq, polviews, fefam, natfare)</span>
<span id="cb5-7"><a href="4-Chapter_3.html#cb5-7"></a></span>
<span id="cb5-8"><a href="4-Chapter_3.html#cb5-8"></a><span class="co"># Model 1 - Independence Model</span></span>
<span id="cb5-9"><a href="4-Chapter_3.html#cb5-9"></a>M1 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span></span>
<span id="cb5-10"><a href="4-Chapter_3.html#cb5-10"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>natfare, <span class="dt">family =</span> poisson, <span class="dt">data =</span> ., <span class="dt">trace =</span> F, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb5-11"><a href="4-Chapter_3.html#cb5-11"></a></span>
<span id="cb5-12"><a href="4-Chapter_3.html#cb5-12"></a><span class="co"># Model 2 - Full Two-way Interaction</span></span>
<span id="cb5-13"><a href="4-Chapter_3.html#cb5-13"></a>M2 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span></span>
<span id="cb5-14"><a href="4-Chapter_3.html#cb5-14"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews<span class="op">*</span>fefam <span class="op">+</span><span class="st"> </span>fefam<span class="op">*</span>natfare <span class="op">+</span><span class="st"> </span>polviews<span class="op">*</span>natfare, <span class="dt">family =</span> poisson,</span>
<span id="cb5-15"><a href="4-Chapter_3.html#cb5-15"></a>      <span class="dt">data =</span> ., <span class="dt">trace =</span> F, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb5-16"><a href="4-Chapter_3.html#cb5-16"></a></span>
<span id="cb5-17"><a href="4-Chapter_3.html#cb5-17"></a><span class="co"># Model 3 - Conditional Independence on polviews</span></span>
<span id="cb5-18"><a href="4-Chapter_3.html#cb5-18"></a>M3 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span></span>
<span id="cb5-19"><a href="4-Chapter_3.html#cb5-19"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews<span class="op">*</span>fefam <span class="op">+</span><span class="st"> </span>polviews<span class="op">*</span>natfare, <span class="dt">family =</span> poisson,</span>
<span id="cb5-20"><a href="4-Chapter_3.html#cb5-20"></a>      <span class="dt">data =</span> ., <span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb5-21"><a href="4-Chapter_3.html#cb5-21"></a></span>
<span id="cb5-22"><a href="4-Chapter_3.html#cb5-22"></a><span class="co"># Model 4 - Conditional Independence on fefam</span></span>
<span id="cb5-23"><a href="4-Chapter_3.html#cb5-23"></a>M4 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span></span>
<span id="cb5-24"><a href="4-Chapter_3.html#cb5-24"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews<span class="op">*</span>fefam <span class="op">+</span><span class="st"> </span>fefam<span class="op">*</span>natfare, <span class="dt">family =</span> poisson,</span>
<span id="cb5-25"><a href="4-Chapter_3.html#cb5-25"></a>      <span class="dt">data =</span> ., <span class="dt">trace =</span> F, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb5-26"><a href="4-Chapter_3.html#cb5-26"></a></span>
<span id="cb5-27"><a href="4-Chapter_3.html#cb5-27"></a><span class="co"># Model 5 - Conditional Independence on natfare</span></span>
<span id="cb5-28"><a href="4-Chapter_3.html#cb5-28"></a>M5 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span></span>
<span id="cb5-29"><a href="4-Chapter_3.html#cb5-29"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>fefam<span class="op">*</span>natfare <span class="op">+</span><span class="st"> </span>polviews<span class="op">*</span>natfare, <span class="dt">family =</span> poisson,</span>
<span id="cb5-30"><a href="4-Chapter_3.html#cb5-30"></a>      <span class="dt">data =</span> ., <span class="dt">trace =</span> F, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb5-31"><a href="4-Chapter_3.html#cb5-31"></a></span>
<span id="cb5-32"><a href="4-Chapter_3.html#cb5-32"></a><span class="co"># Model 6 - RC(1)+RL(1) partial association</span></span>
<span id="cb5-33"><a href="4-Chapter_3.html#cb5-33"></a>M6 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span></span>
<span id="cb5-34"><a href="4-Chapter_3.html#cb5-34"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>natfare <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb5-35"><a href="4-Chapter_3.html#cb5-35"></a>      <span class="dt">data =</span> ., </span>
<span id="cb5-36"><a href="4-Chapter_3.html#cb5-36"></a>      <span class="dt">family =</span> poisson, </span>
<span id="cb5-37"><a href="4-Chapter_3.html#cb5-37"></a>      <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
.............
Done</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="4-Chapter_3.html#cb7-1"></a><span class="co"># Model 7 - RC(1)+RL(1) partial association (consistent row scores - polviews)</span></span>
<span id="cb7-2"><a href="4-Chapter_3.html#cb7-2"></a>M7 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span></span>
<span id="cb7-3"><a href="4-Chapter_3.html#cb7-3"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>natfare <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, fefam <span class="op">+</span><span class="st"> </span>natfare),</span>
<span id="cb7-4"><a href="4-Chapter_3.html#cb7-4"></a>      <span class="dt">data =</span> ., <span class="dt">family =</span> poisson, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations..................................................
Done</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="4-Chapter_3.html#cb9-1"></a><span class="co"># Model 8 - RC(1)+RL(1) partial association (consistent row scores - polviews)</span></span>
<span id="cb9-2"><a href="4-Chapter_3.html#cb9-2"></a><span class="co"># equality restrictions on row scores</span></span>
<span id="cb9-3"><a href="4-Chapter_3.html#cb9-3"></a></span>
<span id="cb9-4"><a href="4-Chapter_3.html#cb9-4"></a>freq_tab_<span class="fl">3.1</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb9-5"><a href="4-Chapter_3.html#cb9-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">polviews.c =</span> polviews)</span>
<span id="cb9-6"><a href="4-Chapter_3.html#cb9-6"></a></span>
<span id="cb9-7"><a href="4-Chapter_3.html#cb9-7"></a><span class="kw">levels</span>(freq_tab_<span class="fl">3.1</span><span class="op">$</span>polviews.c) &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb9-8"><a href="4-Chapter_3.html#cb9-8"></a></span>
<span id="cb9-9"><a href="4-Chapter_3.html#cb9-9"></a>M8 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span></span>
<span id="cb9-10"><a href="4-Chapter_3.html#cb9-10"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>natfare <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews.c, fefam <span class="op">+</span><span class="st"> </span>natfare),</span>
<span id="cb9-11"><a href="4-Chapter_3.html#cb9-11"></a>      <span class="dt">data =</span> ., <span class="dt">family =</span> poisson, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
....
Done</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="4-Chapter_3.html#cb11-1"></a><span class="co">## 表3.2</span></span>
<span id="cb11-2"><a href="4-Chapter_3.html#cb11-2"></a>M &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb11-3"><a href="4-Chapter_3.html#cb11-3"></a>M[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(M1) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-4"><a href="4-Chapter_3.html#cb11-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Model Description</span><span class="st">`</span> =<span class="st"> &quot;1. Complete independence&quot;</span>)</span>
<span id="cb11-5"><a href="4-Chapter_3.html#cb11-5"></a>M[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(M2) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-6"><a href="4-Chapter_3.html#cb11-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Model Description</span><span class="st">`</span> =<span class="st"> &quot;2. Full two-way interaction&quot;</span>)</span>
<span id="cb11-7"><a href="4-Chapter_3.html#cb11-7"></a>M[[<span class="dv">3</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(M3) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-8"><a href="4-Chapter_3.html#cb11-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Model Description</span><span class="st">`</span> =<span class="st"> &quot;3. Conditional independence on POLVIEWS&quot;</span>)</span>
<span id="cb11-9"><a href="4-Chapter_3.html#cb11-9"></a>M[[<span class="dv">4</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(M4) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-10"><a href="4-Chapter_3.html#cb11-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Model Description</span><span class="st">`</span> =<span class="st"> &quot;4. Conditional independence on FEFAM&quot;</span>)</span>
<span id="cb11-11"><a href="4-Chapter_3.html#cb11-11"></a>M[[<span class="dv">5</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(M5) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-12"><a href="4-Chapter_3.html#cb11-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Model Description</span><span class="st">`</span> =<span class="st"> &quot;5. Conditional independence on NATFARE&quot;</span>)</span>
<span id="cb11-13"><a href="4-Chapter_3.html#cb11-13"></a>M[[<span class="dv">6</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(M6) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-14"><a href="4-Chapter_3.html#cb11-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Model Description</span><span class="st">`</span> =<span class="st"> &quot;6. RC(1) + RL(1) partial association&quot;</span>)</span>
<span id="cb11-15"><a href="4-Chapter_3.html#cb11-15"></a>M[[<span class="dv">7</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(M7) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-16"><a href="4-Chapter_3.html#cb11-16"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Model Description</span><span class="st">`</span> =<span class="st"> &quot;7. Model 6 plus consisitent row (POLVIEWS) score restrictions&quot;</span>)</span>
<span id="cb11-17"><a href="4-Chapter_3.html#cb11-17"></a>M[[<span class="dv">8</span>]] &lt;-<span class="st"> </span><span class="kw">model.summary</span>(M8) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-18"><a href="4-Chapter_3.html#cb11-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Model Description</span><span class="st">`</span> =<span class="st"> &quot;8. Model 6 plus consisitent and equality restrictions on row (POLVIEWS) scores (mu_1 = mu_2, mu_4 = mu_5)&quot;</span>)</span>
<span id="cb11-19"><a href="4-Chapter_3.html#cb11-19"></a>M <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>()</span></code></pre></div>
<pre><code># A tibble: 8 x 6
  `Model Description`                                 df    L2   BIC Delta     p
  &lt;chr&gt;                                            &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1. Complete independence                            72 168.  -324. 14.1  1.00 
2 2. Full two-way interaction                         36  35.4 -211.  5.72 0.501
3 3. Conditional independence on POLVIEWS             42  47.3 -240.  7.30 0.733
4 4. Conditional independence on FEFAM                48  87.3 -241. 10.3  1.00 
5 5. Conditional independence on NATFARE              54  91.0 -278. 10.1  0.999
6 6. RC(1) + RL(1) partial association                57  68.6 -321.  8.83 0.860
7 7. Model 6 plus consisitent row (POLVIEWS) scor…    62  72.8 -351.  9.07 0.835
8 8. Model 6 plus consisitent and equality restri…    64  73.6 -364.  9.21 0.807</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="4-Chapter_3.html#cb13-1"></a><span class="co"># Estimating standard error</span></span>
<span id="cb13-2"><a href="4-Chapter_3.html#cb13-2"></a></span>
<span id="cb13-3"><a href="4-Chapter_3.html#cb13-3"></a><span class="co"># Model 6</span></span>
<span id="cb13-4"><a href="4-Chapter_3.html#cb13-4"></a><span class="co"># mu1[i], i = 1 to 7</span></span>
<span id="cb13-5"><a href="4-Chapter_3.html#cb13-5"></a>mu1 &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(M6, <span class="kw">pickCoef</span>(M6, <span class="st">&quot;[.]polviews&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>], <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb13-6"><a href="4-Chapter_3.html#cb13-6"></a>                    <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb13-7"><a href="4-Chapter_3.html#cb13-7"></a><span class="co"># nu[j], j = 1 to 4</span></span>
<span id="cb13-8"><a href="4-Chapter_3.html#cb13-8"></a>nu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(M6, <span class="kw">pickCoef</span>(M6, <span class="st">&quot;[.]fefam&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb13-9"><a href="4-Chapter_3.html#cb13-9"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb13-10"><a href="4-Chapter_3.html#cb13-10"></a><span class="co"># mu2[i], i = 1 to 7</span></span>
<span id="cb13-11"><a href="4-Chapter_3.html#cb13-11"></a>mu2 &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(M6, <span class="kw">pickCoef</span>(M6, <span class="st">&quot;[.]polviews&quot;</span>)[<span class="dv">8</span><span class="op">:</span><span class="dv">14</span>], <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb13-12"><a href="4-Chapter_3.html#cb13-12"></a>                    <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb13-13"><a href="4-Chapter_3.html#cb13-13"></a><span class="co"># eta[k], k = 1 to 3</span></span>
<span id="cb13-14"><a href="4-Chapter_3.html#cb13-14"></a>eta &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(M6, <span class="kw">pickCoef</span>(M6, <span class="st">&quot;[.]natfare&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb13-15"><a href="4-Chapter_3.html#cb13-15"></a>                    <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb13-16"><a href="4-Chapter_3.html#cb13-16"></a></span>
<span id="cb13-17"><a href="4-Chapter_3.html#cb13-17"></a>con &lt;-<span class="st"> </span><span class="kw">c</span>(mu1<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], nu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb13-18"><a href="4-Chapter_3.html#cb13-18"></a>         mu2<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], eta<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span>
<span id="cb13-19"><a href="4-Chapter_3.html#cb13-19"></a></span>
<span id="cb13-20"><a href="4-Chapter_3.html#cb13-20"></a>M6_SE &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span></span>
<span id="cb13-21"><a href="4-Chapter_3.html#cb13-21"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>natfare <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb13-22"><a href="4-Chapter_3.html#cb13-22"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">14</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span>,<span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), <span class="dt">constrainTo =</span> con,</span>
<span id="cb13-23"><a href="4-Chapter_3.html#cb13-23"></a>      <span class="dt">data =</span> ., <span class="dt">family =</span> poisson, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
..........................
Done</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="4-Chapter_3.html#cb15-1"></a>M6_SE_coef &lt;-<span class="st"> </span><span class="kw">summary</span>(M6_SE) <span class="op">%&gt;%</span></span>
<span id="cb15-2"><a href="4-Chapter_3.html#cb15-2"></a><span class="st">  </span><span class="kw">coefficients</span>() <span class="op">%&gt;%</span></span>
<span id="cb15-3"><a href="4-Chapter_3.html#cb15-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb15-4"><a href="4-Chapter_3.html#cb15-4"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb15-5"><a href="4-Chapter_3.html#cb15-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Mult&quot;</span>,Variable))</span>
<span id="cb15-6"><a href="4-Chapter_3.html#cb15-6"></a></span>
<span id="cb15-7"><a href="4-Chapter_3.html#cb15-7"></a></span>
<span id="cb15-8"><a href="4-Chapter_3.html#cb15-8"></a><span class="co"># Model 7</span></span>
<span id="cb15-9"><a href="4-Chapter_3.html#cb15-9"></a><span class="co"># mu[i], i = 1 to 7</span></span>
<span id="cb15-10"><a href="4-Chapter_3.html#cb15-10"></a>mu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(M7, <span class="kw">pickCoef</span>(M7, <span class="st">&quot;[.]polviews&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>], <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb15-11"><a href="4-Chapter_3.html#cb15-11"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb15-12"><a href="4-Chapter_3.html#cb15-12"></a></span>
<span id="cb15-13"><a href="4-Chapter_3.html#cb15-13"></a>con &lt;-<span class="st"> </span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)], mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)])</span>
<span id="cb15-14"><a href="4-Chapter_3.html#cb15-14"></a></span>
<span id="cb15-15"><a href="4-Chapter_3.html#cb15-15"></a>M7_SE &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span></span>
<span id="cb15-16"><a href="4-Chapter_3.html#cb15-16"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>natfare <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb15-17"><a href="4-Chapter_3.html#cb15-17"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">14</span><span class="op">:</span><span class="dv">20</span>, <span class="dv">26</span><span class="op">:</span><span class="dv">32</span>), <span class="dt">constrainTo =</span> con,</span>
<span id="cb15-18"><a href="4-Chapter_3.html#cb15-18"></a>      <span class="dt">data =</span> ., <span class="dt">family =</span> poisson, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="4-Chapter_3.html#cb17-1"></a><span class="co"># nu[j], j = 1 to 4</span></span>
<span id="cb17-2"><a href="4-Chapter_3.html#cb17-2"></a>nu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(M7_SE, <span class="kw">pickCoef</span>(M7_SE, <span class="st">&quot;[.]fefam&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb17-3"><a href="4-Chapter_3.html#cb17-3"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb17-4"><a href="4-Chapter_3.html#cb17-4"></a><span class="co"># eta[k], k = 1 to 3</span></span>
<span id="cb17-5"><a href="4-Chapter_3.html#cb17-5"></a>eta &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(M7_SE, <span class="kw">pickCoef</span>(M7_SE, <span class="st">&quot;[.]natfare&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb17-6"><a href="4-Chapter_3.html#cb17-6"></a>                    <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb17-7"><a href="4-Chapter_3.html#cb17-7"></a></span>
<span id="cb17-8"><a href="4-Chapter_3.html#cb17-8"></a>con &lt;-<span class="st"> </span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)], nu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb17-9"><a href="4-Chapter_3.html#cb17-9"></a>         mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)], eta<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span>
<span id="cb17-10"><a href="4-Chapter_3.html#cb17-10"></a></span>
<span id="cb17-11"><a href="4-Chapter_3.html#cb17-11"></a>M7_SE &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span></span>
<span id="cb17-12"><a href="4-Chapter_3.html#cb17-12"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>natfare <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb17-13"><a href="4-Chapter_3.html#cb17-13"></a>      <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">14</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span><span class="op">:</span><span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), <span class="dt">constrainTo =</span> con,</span>
<span id="cb17-14"><a href="4-Chapter_3.html#cb17-14"></a>      <span class="dt">data =</span> ., <span class="dt">family =</span> poisson, <span class="dt">trace =</span> T, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Initial Deviance = 168.761227
Running start-up iterations
Start-up iteration 1. Deviance = 74.557760
Start-up iteration 2. Deviance = 72.914158
Running main iterations
Iteration 1. Deviance = 72.773896
Iteration 2. Deviance = 72.773834
Iteration 3. Deviance = 72.773834
Done</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="4-Chapter_3.html#cb19-1"></a>M7_SE_coef &lt;-<span class="st"> </span><span class="kw">summary</span>(M7_SE) <span class="op">%&gt;%</span></span>
<span id="cb19-2"><a href="4-Chapter_3.html#cb19-2"></a><span class="st">  </span><span class="kw">coefficients</span>() <span class="op">%&gt;%</span></span>
<span id="cb19-3"><a href="4-Chapter_3.html#cb19-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb19-4"><a href="4-Chapter_3.html#cb19-4"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb19-5"><a href="4-Chapter_3.html#cb19-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Mult&quot;</span>,Variable))</span>
<span id="cb19-6"><a href="4-Chapter_3.html#cb19-6"></a></span>
<span id="cb19-7"><a href="4-Chapter_3.html#cb19-7"></a><span class="co"># Model 8</span></span>
<span id="cb19-8"><a href="4-Chapter_3.html#cb19-8"></a><span class="co"># mu[i], i = 1 to 7</span></span>
<span id="cb19-9"><a href="4-Chapter_3.html#cb19-9"></a>mu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(M8, <span class="kw">pickCoef</span>(M8, <span class="st">&quot;[.]polviews.c&quot;</span>),</span>
<span id="cb19-10"><a href="4-Chapter_3.html#cb19-10"></a>                   <span class="dt">ref =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">/</span><span class="dv">7</span>, <span class="dt">scaleRef =</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">/</span><span class="dv">7</span>,</span>
<span id="cb19-11"><a href="4-Chapter_3.html#cb19-11"></a>                   <span class="dt">scaleWeights=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb19-12"><a href="4-Chapter_3.html#cb19-12"></a></span>
<span id="cb19-13"><a href="4-Chapter_3.html#cb19-13"></a>mu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(M8, <span class="kw">pickCoef</span>(M8, <span class="st">&quot;[.]polviews.c&quot;</span>),</span>
<span id="cb19-14"><a href="4-Chapter_3.html#cb19-14"></a>                   <span class="dt">ref =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">/</span><span class="dv">7</span>, <span class="dt">scaleRef =</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">/</span><span class="dv">7</span>,</span>
<span id="cb19-15"><a href="4-Chapter_3.html#cb19-15"></a>                   <span class="dt">scaleWeights=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb19-16"><a href="4-Chapter_3.html#cb19-16"></a></span>
<span id="cb19-17"><a href="4-Chapter_3.html#cb19-17"></a>con &lt;-<span class="st"> </span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)], mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)])</span>
<span id="cb19-18"><a href="4-Chapter_3.html#cb19-18"></a></span>
<span id="cb19-19"><a href="4-Chapter_3.html#cb19-19"></a>M8 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>natfare <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb19-20"><a href="4-Chapter_3.html#cb19-20"></a>          <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">14</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">26</span><span class="op">:</span><span class="dv">32</span>), <span class="dt">constrainTo =</span> con,</span>
<span id="cb19-21"><a href="4-Chapter_3.html#cb19-21"></a>          <span class="dt">data =</span> ., <span class="dt">family =</span> poisson, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="4-Chapter_3.html#cb21-1"></a><span class="kw">summary</span>(M8)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ polviews + fefam + natfare + Mult(1, polviews, 
    fefam) + Mult(1, polviews, natfare), constrain = c(14:20, 
    26:32), constrainTo = con, family = poisson, data = ., tolerance = 1e-12)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.09613  -0.69364  -0.06107   0.52149   2.13382  

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                    0.494059         NA      NA       NA    
polviews2                      1.047319   0.183771   5.699 1.20e-08 ***
polviews3                      1.015164         NA      NA       NA    
polviews4                      2.327750         NA      NA       NA    
polviews5                      1.321674         NA      NA       NA    
polviews6                      1.254444         NA      NA       NA    
polviews7                     -0.123528         NA      NA       NA    
fefam2                         0.993418   0.095568  10.395  &lt; 2e-16 ***
fefam3                         0.451237   0.104313   4.326 1.52e-05 ***
fefam4                        -0.839900   0.148980  -5.638 1.72e-08 ***
natfare2                       0.345798   0.085610   4.039 5.36e-05 ***
natfare3                       0.302261   0.086847   3.480 0.000501 ***
Mult(., polviews, fefam).      0.163148         NA      NA       NA    
Mult(1, ., fefam).polviews1   -0.402725         NA      NA       NA    
Mult(1, ., fefam).polviews2   -0.402725         NA      NA       NA    
Mult(1, ., fefam).polviews3   -0.278981         NA      NA       NA    
Mult(1, ., fefam).polviews4   -0.001962         NA      NA       NA    
Mult(1, ., fefam).polviews5   -0.001962         NA      NA       NA    
Mult(1, ., fefam).polviews6    0.491603         NA      NA       NA    
Mult(1, ., fefam).polviews7    0.596753         NA      NA       NA    
Mult(1, polviews, .).fefam1   -7.746085         NA      NA       NA    
Mult(1, polviews, .).fefam2   -0.960123         NA      NA       NA    
Mult(1, polviews, .).fefam3    4.698011         NA      NA       NA    
Mult(1, polviews, .).fefam4    7.903679         NA      NA       NA    
Mult(., polviews, natfare).    4.627056         NA      NA       NA    
Mult(1, ., natfare).polviews1 -0.402725         NA      NA       NA    
Mult(1, ., natfare).polviews2 -0.402725         NA      NA       NA    
Mult(1, ., natfare).polviews3 -0.278981         NA      NA       NA    
Mult(1, ., natfare).polviews4 -0.001962         NA      NA       NA    
Mult(1, ., natfare).polviews5 -0.001962         NA      NA       NA    
Mult(1, ., natfare).polviews6  0.491603         NA      NA       NA    
Mult(1, ., natfare).polviews7  0.596753         NA      NA       NA    
Mult(1, polviews, .).natfare1 -0.208030         NA      NA       NA    
Mult(1, polviews, .).natfare2 -0.101990         NA      NA       NA    
Mult(1, polviews, .).natfare3  0.207269         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 73.594 on 67 degrees of freedom
AIC: 411.62

Number of iterations: 3</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="4-Chapter_3.html#cb23-1"></a><span class="co"># nu[j], j = 1 to 4</span></span>
<span id="cb23-2"><a href="4-Chapter_3.html#cb23-2"></a>nu &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(M8, <span class="kw">pickCoef</span>(M8, <span class="st">&quot;[.]fefam&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb23-3"><a href="4-Chapter_3.html#cb23-3"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb23-4"><a href="4-Chapter_3.html#cb23-4"></a></span>
<span id="cb23-5"><a href="4-Chapter_3.html#cb23-5"></a><span class="co"># eta[k], k = 1 to 3</span></span>
<span id="cb23-6"><a href="4-Chapter_3.html#cb23-6"></a>eta &lt;-<span class="st"> </span><span class="kw">getContrasts</span>(M8, <span class="kw">pickCoef</span>(M8, <span class="st">&quot;[.]natfare&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb23-7"><a href="4-Chapter_3.html#cb23-7"></a>                    <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb23-8"><a href="4-Chapter_3.html#cb23-8"></a></span>
<span id="cb23-9"><a href="4-Chapter_3.html#cb23-9"></a>con &lt;-<span class="st"> </span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)], nu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],</span>
<span id="cb23-10"><a href="4-Chapter_3.html#cb23-10"></a>         mu<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)], eta<span class="op">$</span>qvframe[,<span class="dv">1</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span>
<span id="cb23-11"><a href="4-Chapter_3.html#cb23-11"></a></span>
<span id="cb23-12"><a href="4-Chapter_3.html#cb23-12"></a>M8_SE &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>polviews <span class="op">+</span><span class="st"> </span>fefam <span class="op">+</span><span class="st"> </span>natfare <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, fefam) <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>, polviews, natfare),</span>
<span id="cb23-13"><a href="4-Chapter_3.html#cb23-13"></a>          <span class="dt">constrain =</span> <span class="kw">c</span>(<span class="dv">14</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span><span class="op">:</span><span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">35</span>), <span class="dt">constrainTo =</span> con,</span>
<span id="cb23-14"><a href="4-Chapter_3.html#cb23-14"></a>          <span class="dt">data =</span> ., <span class="dt">family =</span> poisson, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations..................
Done</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="4-Chapter_3.html#cb25-1"></a>M8_SE_coef &lt;-<span class="st"> </span><span class="kw">summary</span>(M8_SE) <span class="op">%&gt;%</span></span>
<span id="cb25-2"><a href="4-Chapter_3.html#cb25-2"></a><span class="st">  </span><span class="kw">coefficients</span>() <span class="op">%&gt;%</span></span>
<span id="cb25-3"><a href="4-Chapter_3.html#cb25-3"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb25-4"><a href="4-Chapter_3.html#cb25-4"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;Variable&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb25-5"><a href="4-Chapter_3.html#cb25-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Mult&quot;</span>,Variable))</span>
<span id="cb25-6"><a href="4-Chapter_3.html#cb25-6"></a></span>
<span id="cb25-7"><a href="4-Chapter_3.html#cb25-7"></a></span>
<span id="cb25-8"><a href="4-Chapter_3.html#cb25-8"></a><span class="kw">bind_cols</span>(</span>
<span id="cb25-9"><a href="4-Chapter_3.html#cb25-9"></a>M6_SE_coef <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="dt">Model6 =</span> Estimate),</span>
<span id="cb25-10"><a href="4-Chapter_3.html#cb25-10"></a>M7_SE_coef <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">Model7 =</span> Estimate),</span>
<span id="cb25-11"><a href="4-Chapter_3.html#cb25-11"></a>M8_SE_coef <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">Model8 =</span> Estimate))</span></code></pre></div>
<pre><code>                        Variable      Model6      Model7       Model8
1      Mult(., polviews, fefam).  1.98292236 -1.94985651  1.941869008
2    Mult(1, ., fefam).polviews1 -0.18890704 -0.41258265 -0.402725149
3    Mult(1, ., fefam).polviews2 -0.45611586 -0.38551616 -0.402725149
4    Mult(1, ., fefam).polviews3 -0.36505971 -0.26877471 -0.278981096
5    Mult(1, ., fefam).polviews4 -0.01292237  0.02747595 -0.001961895
6    Mult(1, ., fefam).polviews5 -0.06262362 -0.05550221 -0.001961895
7    Mult(1, ., fefam).polviews6  0.42111705  0.49418258  0.491602614
8    Mult(1, ., fefam).polviews7  0.66451154  0.60071720  0.596752569
9    Mult(1, polviews, .).fefam1 -0.70268861  0.72624699 -0.732615689
10   Mult(1, polviews, .).fefam2 -0.20817046  0.17021171 -0.162486357
11   Mult(1, polviews, .).fefam3  0.30041075 -0.30370570  0.312887371
12   Mult(1, polviews, .).fefam4  0.61044832 -0.59275300  0.582214676
13   Mult(., polviews, natfare).  1.56691378 -1.43774015  1.411968172
14 Mult(1, ., natfare).polviews1 -0.60584367 -0.41258265 -0.402725149
15 Mult(1, ., natfare).polviews2 -0.27518966 -0.38551616 -0.402725149
16 Mult(1, ., natfare).polviews3 -0.15821154 -0.26877471 -0.278981096
17 Mult(1, ., natfare).polviews4  0.06460260  0.02747595 -0.001961895
18 Mult(1, ., natfare).polviews5 -0.05050796 -0.05550221 -0.001961895
19 Mult(1, ., natfare).polviews6  0.51153570  0.49418258  0.491602614
20 Mult(1, ., natfare).polviews7  0.51361453  0.60071720  0.596752569
21 Mult(1, polviews, .).natfare1 -0.60734824  0.58021189 -0.569479796
22 Mult(1, polviews, .).natfare2 -0.16892093  0.20740348 -0.221984457
23 Mult(1, polviews, .).natfare3  0.77626917 -0.78761536  0.791464253</code></pre>
</div>
<div id="表3.1b" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> 表3.1B</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="4-Chapter_3.html#cb27-1"></a><span class="co"># 表3.1</span></span>
<span id="cb27-2"><a href="4-Chapter_3.html#cb27-2"></a>Freq&lt;-<span class="kw">c</span>(<span class="dv">76</span>, <span class="dv">14</span>, <span class="dv">15</span>,  <span class="dv">4</span>,</span>
<span id="cb27-3"><a href="4-Chapter_3.html#cb27-3"></a>        <span class="dv">32</span>, <span class="dv">17</span>,  <span class="dv">7</span>,  <span class="dv">3</span>,</span>
<span id="cb27-4"><a href="4-Chapter_3.html#cb27-4"></a>        <span class="dv">64</span>, <span class="dv">23</span>, <span class="dv">28</span>, <span class="dv">15</span>,</span>
<span id="cb27-5"><a href="4-Chapter_3.html#cb27-5"></a>        <span class="dv">41</span>, <span class="dv">11</span>, <span class="dv">27</span>, <span class="dv">16</span>,</span>
<span id="cb27-6"><a href="4-Chapter_3.html#cb27-6"></a>        <span class="dv">15</span>,  <span class="dv">2</span>,  <span class="dv">7</span>,  <span class="dv">4</span>,</span>
<span id="cb27-7"><a href="4-Chapter_3.html#cb27-7"></a>        <span class="dv">27</span>, <span class="dv">20</span>,  <span class="dv">9</span>,  <span class="dv">5</span>,</span>
<span id="cb27-8"><a href="4-Chapter_3.html#cb27-8"></a>        <span class="dv">57</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">15</span>,</span>
<span id="cb27-9"><a href="4-Chapter_3.html#cb27-9"></a>        <span class="dv">27</span>,  <span class="dv">9</span>, <span class="dv">22</span>, <span class="dv">16</span>,</span>
<span id="cb27-10"><a href="4-Chapter_3.html#cb27-10"></a>        <span class="dv">13</span>,  <span class="dv">6</span>, <span class="dv">13</span>,  <span class="dv">5</span>,</span>
<span id="cb27-11"><a href="4-Chapter_3.html#cb27-11"></a>        <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">10</span>,  <span class="dv">6</span>,</span>
<span id="cb27-12"><a href="4-Chapter_3.html#cb27-12"></a>        <span class="dv">46</span>, <span class="dv">32</span>, <span class="dv">75</span>, <span class="dv">20</span>,</span>
<span id="cb27-13"><a href="4-Chapter_3.html#cb27-13"></a>        <span class="dv">54</span>, <span class="dv">26</span>, <span class="dv">58</span>, <span class="dv">55</span>,</span>
<span id="cb27-14"><a href="4-Chapter_3.html#cb27-14"></a>        <span class="dv">7</span>,  <span class="dv">6</span>,  <span class="dv">7</span>,  <span class="dv">6</span>,</span>
<span id="cb27-15"><a href="4-Chapter_3.html#cb27-15"></a>        <span class="dv">7</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">6</span>,</span>
<span id="cb27-16"><a href="4-Chapter_3.html#cb27-16"></a>        <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">31</span>, <span class="dv">15</span>,</span>
<span id="cb27-17"><a href="4-Chapter_3.html#cb27-17"></a>        <span class="dv">52</span>, <span class="dv">36</span>, <span class="dv">80</span>,<span class="dv">101</span>)</span>
<span id="cb27-18"><a href="4-Chapter_3.html#cb27-18"></a></span>
<span id="cb27-19"><a href="4-Chapter_3.html#cb27-19"></a>L&lt;-<span class="kw">gl</span>(<span class="dv">4</span>,<span class="dv">16</span>,<span class="dv">64</span>)</span>
<span id="cb27-20"><a href="4-Chapter_3.html#cb27-20"></a>R&lt;-<span class="kw">gl</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">64</span>)</span>
<span id="cb27-21"><a href="4-Chapter_3.html#cb27-21"></a>C&lt;-<span class="kw">gl</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">64</span>)</span>
<span id="cb27-22"><a href="4-Chapter_3.html#cb27-22"></a></span>
<span id="cb27-23"><a href="4-Chapter_3.html#cb27-23"></a>freq_tab_<span class="fl">3.1</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(Freq, L, R, C) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(L, R, C)</span>
<span id="cb27-24"><a href="4-Chapter_3.html#cb27-24"></a>freq_tab_<span class="fl">3.1</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb27-25"><a href="4-Chapter_3.html#cb27-25"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Rscore =</span> <span class="kw">as.numeric</span>(R),</span>
<span id="cb27-26"><a href="4-Chapter_3.html#cb27-26"></a>         <span class="dt">Cscore =</span> <span class="kw">as.numeric</span>(C),</span>
<span id="cb27-27"><a href="4-Chapter_3.html#cb27-27"></a>         <span class="dt">Lscore =</span> <span class="kw">as.numeric</span>(L))</span>
<span id="cb27-28"><a href="4-Chapter_3.html#cb27-28"></a><span class="co"># Model 1 - Complete Independence</span></span>
<span id="cb27-29"><a href="4-Chapter_3.html#cb27-29"></a>model1 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-30"><a href="4-Chapter_3.html#cb27-30"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>R <span class="op">+</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span>L, </span>
<span id="cb27-31"><a href="4-Chapter_3.html#cb27-31"></a>                               <span class="dt">data =</span>., </span>
<span id="cb27-32"><a href="4-Chapter_3.html#cb27-32"></a>                               <span class="dt">family =</span> poisson, </span>
<span id="cb27-33"><a href="4-Chapter_3.html#cb27-33"></a>                               <span class="dt">trace =</span> F, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb27-34"><a href="4-Chapter_3.html#cb27-34"></a></span>
<span id="cb27-35"><a href="4-Chapter_3.html#cb27-35"></a><span class="co"># Model 2 - Unrestricted RC(1)+RL(1)+CL(1)</span></span>
<span id="cb27-36"><a href="4-Chapter_3.html#cb27-36"></a>model2 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-37"><a href="4-Chapter_3.html#cb27-37"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>R <span class="op">+</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span>L <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C) <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,R,L) <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,C,L), </span>
<span id="cb27-38"><a href="4-Chapter_3.html#cb27-38"></a>                               <span class="dt">data =</span> .,</span>
<span id="cb27-39"><a href="4-Chapter_3.html#cb27-39"></a>                               <span class="dt">family =</span> poisson,</span>
<span id="cb27-40"><a href="4-Chapter_3.html#cb27-40"></a>                               <span class="dt">trace =</span> F, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
...............................
Done</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="4-Chapter_3.html#cb29-1"></a><span class="co"># Model 3 - Restricted RC(1)+RL(1)+CL(1) with consistent score</span></span>
<span id="cb29-2"><a href="4-Chapter_3.html#cb29-2"></a><span class="co"># It may not be fitted with gnm package!</span></span>
<span id="cb29-3"><a href="4-Chapter_3.html#cb29-3"></a>model3 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-4"><a href="4-Chapter_3.html#cb29-4"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>R <span class="op">+</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span>L <span class="op">+</span><span class="st"> </span><span class="kw">instances</span>(<span class="kw">Mult</span>(R,C),<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">instances</span>(<span class="kw">Mult</span>(R,L),<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">MultHomog</span>(C,L), <span class="dt">family =</span> poisson,</span>
<span id="cb29-5"><a href="4-Chapter_3.html#cb29-5"></a>      <span class="dt">data =</span> .,</span>
<span id="cb29-6"><a href="4-Chapter_3.html#cb29-6"></a>      <span class="dt">trace =</span> F, <span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
...........................................
Done</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="4-Chapter_3.html#cb31-1"></a><span class="kw">summary</span>(model3)</span></code></pre></div>
<pre><code>
Call:

gnm(formula = Freq ~ R + C + L + instances(Mult(R, C), 1) + instances(Mult(R, 
    L), 1) + MultHomog(C, L), family = poisson, data = ., tolerance = 1e-12, 
    trace = F)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.4356  -0.9453  -0.2028   0.6944   4.0080  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)              2.62859         NA      NA       NA
R2                      -0.07202         NA      NA       NA
R3                       1.07687         NA      NA       NA
R4                       1.24252         NA      NA       NA
C2                      -0.74242         NA      NA       NA
C3                      -0.26258         NA      NA       NA
C4                      -0.75368         NA      NA       NA
L2                      -0.14844         NA      NA       NA
L3                       0.33658         NA      NA       NA
L4                      -0.02280         NA      NA       NA
Mult(., C, inst = 1).R1 -1.15021         NA      NA       NA
Mult(., C, inst = 1).R2 -1.82067         NA      NA       NA
Mult(., C, inst = 1).R3 -0.44922         NA      NA       NA
Mult(., C, inst = 1).R4  0.95358         NA      NA       NA
Mult(R, ., inst = 1).C1 -0.09775         NA      NA       NA
Mult(R, ., inst = 1).C2 -0.19482         NA      NA       NA
Mult(R, ., inst = 1).C3  0.10249         NA      NA       NA
Mult(R, ., inst = 1).C4  0.38682         NA      NA       NA
Mult(., L, inst = 1).R1  0.60721         NA      NA       NA
Mult(., L, inst = 1).R2  0.48280         NA      NA       NA
Mult(., L, inst = 1).R3  0.20805         NA      NA       NA
Mult(., L, inst = 1).R4 -0.50448         NA      NA       NA
Mult(R, ., inst = 1).L1  1.04293         NA      NA       NA
Mult(R, ., inst = 1).L2  0.73141         NA      NA       NA
Mult(R, ., inst = 1).L3 -0.06269         NA      NA       NA
Mult(R, ., inst = 1).L4 -1.18855         NA      NA       NA
MultHomog(C, L)1         0.67719         NA      NA       NA
MultHomog(C, L)2         0.16076         NA      NA       NA
MultHomog(C, L)3        -0.32462         NA      NA       NA
MultHomog(C, L)4        -0.69521         NA      NA       NA

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 111.83 on 41 degrees of freedom
AIC: 452.14

Number of iterations: 100</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="4-Chapter_3.html#cb33-1"></a><span class="co"># Model 4 - Model 2 with consistent cells fitted exactly</span></span>
<span id="cb33-2"><a href="4-Chapter_3.html#cb33-2"></a>freq_tab_<span class="fl">3.1</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">consistent.cells =</span> <span class="kw">factor</span>(<span class="kw">ifelse</span>((R<span class="op">==</span>C) <span class="op">&amp;</span><span class="st"> </span>(C<span class="op">==</span>L),<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">0</span>)))</span>
<span id="cb33-3"><a href="4-Chapter_3.html#cb33-3"></a>model4 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-4"><a href="4-Chapter_3.html#cb33-4"></a><span class="st">  </span><span class="kw">gnm</span>(Freq <span class="op">~</span><span class="st"> </span>R <span class="op">+</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span>L <span class="op">+</span><span class="st"> </span>consistent.cells <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C) <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,R,L) <span class="op">+</span><span class="st"> </span><span class="kw">Mult</span>(<span class="dv">1</span>,C,L),</span>
<span id="cb33-5"><a href="4-Chapter_3.html#cb33-5"></a>      <span class="dt">data =</span> .,</span>
<span id="cb33-6"><a href="4-Chapter_3.html#cb33-6"></a>              <span class="dt">family =</span> poisson, <span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.............................................
Done</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="4-Chapter_3.html#cb35-1"></a><span class="co"># Model 5 - Model 3 with consistent cells fitted exactly</span></span>
<span id="cb35-2"><a href="4-Chapter_3.html#cb35-2"></a><span class="co"># It may not be fitted with gnm package!</span></span>
<span id="cb35-3"><a href="4-Chapter_3.html#cb35-3"></a></span>
<span id="cb35-4"><a href="4-Chapter_3.html#cb35-4"></a><span class="co"># Model 6 - Full Two-way interaction</span></span>
<span id="cb35-5"><a href="4-Chapter_3.html#cb35-5"></a>model6 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-6"><a href="4-Chapter_3.html#cb35-6"></a><span class="st">  </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">*</span>C<span class="op">+</span>R<span class="op">*</span>L<span class="op">+</span>C<span class="op">*</span>L,</span>
<span id="cb35-7"><a href="4-Chapter_3.html#cb35-7"></a>      <span class="dt">data =</span> .,</span>
<span id="cb35-8"><a href="4-Chapter_3.html#cb35-8"></a>      ,<span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb35-9"><a href="4-Chapter_3.html#cb35-9"></a><span class="kw">summary</span>(model6)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ R * C + R * L + C * L, family = poisson, 
    data = ., tolerance = 1e-12, trace = F)

Deviance Residuals: 
      Min         1Q     Median         3Q        Max  
-1.685582  -0.504109  -0.008581   0.460359   1.299438  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  4.26029    0.11066  38.499  &lt; 2e-16 ***
R2          -0.79606    0.18519  -4.299 1.72e-05 ***
R3          -0.09579    0.14996  -0.639  0.52299    
R4          -0.43476    0.16083  -2.703  0.00687 ** 
C2          -1.63953    0.22829  -7.182 6.89e-13 ***
C3          -1.39351    0.20261  -6.878 6.08e-12 ***
C4          -2.33707    0.28019  -8.341  &lt; 2e-16 ***
R2:C2        0.90120    0.28232   3.192  0.00141 ** 
R3:C2        0.63274    0.25192   2.512  0.01202 *  
R4:C2        0.33707    0.26138   1.290  0.19719    
R2:C3       -0.06534    0.29098  -0.225  0.82232    
R3:C3        0.66917    0.22004   3.041  0.00236 ** 
R4:C3        0.60286    0.22215   2.714  0.00665 ** 
R2:C4        0.34284    0.36220   0.947  0.34388    
R3:C4        0.56412    0.29673   1.901  0.05729 .  
R4:C4        1.27643    0.28261   4.517 6.29e-06 ***
L2          -1.48502    0.22186  -6.694 2.18e-11 ***
L3          -1.52970    0.20833  -7.343 2.10e-13 ***
L4          -2.08728    0.24553  -8.501  &lt; 2e-16 ***
R2:L2        1.34634    0.28170   4.779 1.76e-06 ***
R3:L2        1.28703    0.24739   5.203 1.97e-07 ***
R4:L2        1.03853    0.26517   3.916 8.99e-05 ***
R2:L3        0.67005    0.28444   2.356  0.01849 *  
R3:L3        1.21742    0.22757   5.350 8.81e-08 ***
R4:L3        1.59671    0.23321   6.847 7.56e-12 ***
R2:L4        0.17240    0.35528   0.485  0.62750    
R3:L4        0.61348    0.27149   2.260  0.02384 *  
R4:L4        2.16906    0.25643   8.459  &lt; 2e-16 ***
C2:L2        0.35033    0.21463   1.632  0.10263    
C3:L2        0.22827    0.20862   1.094  0.27389    
C4:L2        0.49174    0.25839   1.903  0.05703 .  
C2:L3        0.65539    0.20819   3.148  0.00164 ** 
C3:L3        1.09826    0.18400   5.969 2.39e-09 ***
C4:L3        1.11150    0.23123   4.807 1.53e-06 ***
C2:L4        0.87747    0.23892   3.673  0.00024 ***
C3:L4        1.29956    0.20753   6.262 3.80e-10 ***
C4:L4        1.79692    0.23862   7.530 5.06e-14 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Residual deviance: 28.998 on 27 degrees of freedom
AIC: 397.32

Number of iterations: 5</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="4-Chapter_3.html#cb37-1"></a><span class="co"># Model 7 - Model 6 with consistent cells fitted exactly</span></span>
<span id="cb37-2"><a href="4-Chapter_3.html#cb37-2"></a>model7&lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-3"><a href="4-Chapter_3.html#cb37-3"></a><span class="st">  </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">*</span>C<span class="op">+</span>R<span class="op">*</span>L<span class="op">+</span>C<span class="op">*</span>L<span class="op">+</span>consistent.cells,</span>
<span id="cb37-4"><a href="4-Chapter_3.html#cb37-4"></a>      <span class="dt">data =</span> .,</span>
<span id="cb37-5"><a href="4-Chapter_3.html#cb37-5"></a>      <span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span>
<span id="cb37-6"><a href="4-Chapter_3.html#cb37-6"></a></span>
<span id="cb37-7"><a href="4-Chapter_3.html#cb37-7"></a><span class="co"># Model 8 - Unrestricted uniform and log-multiplicative association in all partial</span></span>
<span id="cb37-8"><a href="4-Chapter_3.html#cb37-8"></a><span class="co"># association</span></span>
<span id="cb37-9"><a href="4-Chapter_3.html#cb37-9"></a></span>
<span id="cb37-10"><a href="4-Chapter_3.html#cb37-10"></a>model8 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-11"><a href="4-Chapter_3.html#cb37-11"></a><span class="st">  </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C)<span class="op">+</span></span>
<span id="cb37-12"><a href="4-Chapter_3.html#cb37-12"></a><span class="st">              </span>Rscore<span class="op">:</span>Lscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,L)<span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>Lscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,C,L),</span>
<span id="cb37-13"><a href="4-Chapter_3.html#cb37-13"></a>      <span class="dt">data =</span>.,</span>
<span id="cb37-14"><a href="4-Chapter_3.html#cb37-14"></a>            <span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.........................................................
..........................
Done</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="4-Chapter_3.html#cb39-1"></a><span class="kw">options</span>(<span class="dt">width=</span><span class="dv">90</span>,<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="dt">factor=</span><span class="st">&quot;contr.treatment&quot;</span>, <span class="dt">ordered=</span><span class="st">&quot;contr.treatment&quot;</span>))</span>
<span id="cb39-2"><a href="4-Chapter_3.html#cb39-2"></a><span class="co"># Model 9 - Model 8 with consistent row scores</span></span>
<span id="cb39-3"><a href="4-Chapter_3.html#cb39-3"></a>model9&lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C<span class="op">+</span>L)<span class="op">+</span></span>
<span id="cb39-4"><a href="4-Chapter_3.html#cb39-4"></a><span class="st">              </span>Rscore<span class="op">:</span>Lscore<span class="op">+</span>Cscore<span class="op">:</span>Lscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,C,L),</span>
<span id="cb39-5"><a href="4-Chapter_3.html#cb39-5"></a>              <span class="dt">data =</span> .,</span>
<span id="cb39-6"><a href="4-Chapter_3.html#cb39-6"></a>              <span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................................................

Done</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="4-Chapter_3.html#cb41-1"></a><span class="co">#summary(model9)</span></span>
<span id="cb41-2"><a href="4-Chapter_3.html#cb41-2"></a></span>
<span id="cb41-3"><a href="4-Chapter_3.html#cb41-3"></a>mu&lt;-<span class="kw">getContrasts</span>(model9, <span class="kw">pickCoef</span>(model9, <span class="st">&quot;[.]R&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb41-4"><a href="4-Chapter_3.html#cb41-4"></a>                 <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb41-5"><a href="4-Chapter_3.html#cb41-5"></a></span>
<span id="cb41-6"><a href="4-Chapter_3.html#cb41-6"></a>nu2&lt;-<span class="kw">getContrasts</span>(model9, <span class="kw">pickCoef</span>(model9, <span class="st">&quot;[.]C&quot;</span>)[<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>], <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb41-7"><a href="4-Chapter_3.html#cb41-7"></a>                  <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb41-8"><a href="4-Chapter_3.html#cb41-8"></a></span>
<span id="cb41-9"><a href="4-Chapter_3.html#cb41-9"></a>eta2&lt;-<span class="kw">getContrasts</span>(model9, <span class="kw">pickCoef</span>(model9, <span class="st">&quot;[.]L&quot;</span>)[<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>], <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb41-10"><a href="4-Chapter_3.html#cb41-10"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb41-11"><a href="4-Chapter_3.html#cb41-11"></a></span>
<span id="cb41-12"><a href="4-Chapter_3.html#cb41-12"></a>model9.extended &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C)<span class="op">+</span></span>
<span id="cb41-13"><a href="4-Chapter_3.html#cb41-13"></a><span class="st">                       </span>Rscore<span class="op">:</span>Lscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,L)<span class="op">+</span>Cscore<span class="op">:</span>Lscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,C,L),</span>
<span id="cb41-14"><a href="4-Chapter_3.html#cb41-14"></a>                     <span class="dt">constrain=</span><span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">16</span>,<span class="dv">23</span><span class="op">:</span><span class="dv">26</span>),<span class="dt">constrainTo=</span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>],mu<span class="op">$</span>qvframe[,<span class="dv">1</span>]),</span>
<span id="cb41-15"><a href="4-Chapter_3.html#cb41-15"></a>                     <span class="dt">data =</span> .,</span>
<span id="cb41-16"><a href="4-Chapter_3.html#cb41-16"></a>                     <span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................................................
..........................
Done</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="4-Chapter_3.html#cb43-1"></a><span class="kw">summary</span>(model9.extended)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, 
    L), constrain = c(13:16, 23:26), constrainTo = c(mu$qvframe[, 
    1], mu$qvframe[, 1]), family = poisson, data = ., tolerance = 1e-12,     trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.56526  -0.67024  -0.02438   0.54037   1.98333  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.56160         NA      NA       NA    
R2               -0.94663         NA      NA       NA    
R3               -0.71817         NA      NA       NA    
R4               -1.55450         NA      NA       NA    
C2               -1.58861         NA      NA       NA    
C3               -2.05079         NA      NA       NA    
C4               -3.48065         NA      NA       NA    
L2               -1.38098         NA      NA       NA    
L3               -2.25593         NA      NA       NA    
L4               -3.81349         NA      NA       NA    
Rscore:Cscore     0.13353    0.02520   5.300 1.16e-07 ***
Mult(., R, C).   -0.10054         NA      NA       NA    
Mult(1, ., C).R1 -0.56136         NA      NA       NA    
Mult(1, ., C).R2  0.59333         NA      NA       NA    
Mult(1, ., C).R3  0.39165         NA      NA       NA    
Mult(1, ., C).R4 -0.42362         NA      NA       NA    
Mult(1, R, .).C1  1.41773         NA      NA       NA    
Mult(1, R, .).C2 -4.47477         NA      NA       NA    
Mult(1, R, .).C3 -0.13452         NA      NA       NA    
Mult(1, R, .).C4  4.66268         NA      NA       NA    
Rscore:Lscore     0.24848    0.02521   9.856  &lt; 2e-16 ***
Mult(., R, L).    0.95021         NA      NA       NA    
Mult(1, ., L).R1 -0.56136         NA      NA       NA    
Mult(1, ., L).R2  0.59333         NA      NA       NA    
Mult(1, ., L).R3  0.39165         NA      NA       NA    
Mult(1, ., L).R4 -0.42362         NA      NA       NA    
Mult(1, R, .).L1 -0.04835         NA      NA       NA    
Mult(1, R, .).L2  0.80345         NA      NA       NA    
Mult(1, R, .).L3  0.16329         NA      NA       NA    
Mult(1, R, .).L4 -0.87000         NA      NA       NA    
Cscore:Lscore     0.20270    0.02560   7.919  &lt; 2e-16 ***
Mult(., C, L).    1.40132         NA      NA       NA    
Mult(1, ., L).C1 -0.01979         NA      NA       NA    
Mult(1, ., L).C2  0.12720         NA      NA       NA    
Mult(1, ., L).C3  0.68032         NA      NA       NA    
Mult(1, ., L).C4 -0.06619         NA      NA       NA    
Mult(1, C, .).L1 -0.06182         NA      NA       NA    
Mult(1, C, .).L2 -0.24254         NA      NA       NA    
Mult(1, C, .).L3  0.23273         NA      NA       NA    
Mult(1, C, .).L4 -0.05328         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 47.134 on 40 degrees of freedom
AIC: 389.45

Number of iterations: 93</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="4-Chapter_3.html#cb45-1"></a>nu1&lt;-<span class="kw">getContrasts</span>(model9.extended,</span>
<span id="cb45-2"><a href="4-Chapter_3.html#cb45-2"></a>                  <span class="kw">pickCoef</span>(model9.extended, <span class="st">&quot;[.]C&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb45-3"><a href="4-Chapter_3.html#cb45-3"></a>                  <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb45-4"><a href="4-Chapter_3.html#cb45-4"></a></span>
<span id="cb45-5"><a href="4-Chapter_3.html#cb45-5"></a>eta1&lt;-<span class="kw">getContrasts</span>(model9.extended, <span class="kw">pickCoef</span>(model9.extended, <span class="st">&quot;[.]L&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb45-6"><a href="4-Chapter_3.html#cb45-6"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb45-7"><a href="4-Chapter_3.html#cb45-7"></a></span>
<span id="cb45-8"><a href="4-Chapter_3.html#cb45-8"></a>model9.phis&lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C)<span class="op">+</span></span>
<span id="cb45-9"><a href="4-Chapter_3.html#cb45-9"></a><span class="st">                   </span>Rscore<span class="op">:</span>Lscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,L)<span class="op">+</span>Cscore<span class="op">:</span>Lscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,C,L),</span>
<span id="cb45-10"><a href="4-Chapter_3.html#cb45-10"></a>                 <span class="dt">constrain=</span><span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">23</span><span class="op">:</span><span class="dv">30</span>,<span class="dv">33</span><span class="op">:</span><span class="dv">40</span>),</span>
<span id="cb45-11"><a href="4-Chapter_3.html#cb45-11"></a>                 <span class="dt">constrainTo=</span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>],</span>
<span id="cb45-12"><a href="4-Chapter_3.html#cb45-12"></a>                               nu1<span class="op">$</span>qvframe[,<span class="dv">1</span>],</span>
<span id="cb45-13"><a href="4-Chapter_3.html#cb45-13"></a>                               mu<span class="op">$</span>qvframe[,<span class="dv">1</span>],</span>
<span id="cb45-14"><a href="4-Chapter_3.html#cb45-14"></a>                               eta1<span class="op">$</span>qvframe[,<span class="dv">1</span>],</span>
<span id="cb45-15"><a href="4-Chapter_3.html#cb45-15"></a>                               nu2<span class="op">$</span>qvframe[,<span class="dv">1</span>],</span>
<span id="cb45-16"><a href="4-Chapter_3.html#cb45-16"></a>                               eta2<span class="op">$</span>qvframe[,<span class="dv">1</span>]),</span>
<span id="cb45-17"><a href="4-Chapter_3.html#cb45-17"></a>                 <span class="dt">data =</span> .,</span>
<span id="cb45-18"><a href="4-Chapter_3.html#cb45-18"></a>                 <span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="4-Chapter_3.html#cb47-1"></a><span class="kw">summary</span>(model9.phis);mu;nu1;eta1;nu2;eta2;<span class="kw">model.summary</span>(model9)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    Rscore:Lscore + Mult(1, R, L) + Cscore:Lscore + Mult(1, C, 
    L), constrain = c(13:20, 23:30, 33:40), constrainTo = c(mu$qvframe[, 
    1], nu1$qvframe[, 1], mu$qvframe[, 1], eta1$qvframe[, 1], 
    nu2$qvframe[, 1], eta2$qvframe[, 1]), family = poisson, data = ., 
    tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.56526  -0.67024  -0.02438   0.54037   1.98333  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.56903    0.08137  43.862  &lt; 2e-16 ***
R2               -0.97605    0.11881  -8.215  &lt; 2e-16 ***
R3               -0.74245    0.14810  -5.013 5.36e-07 ***
R4               -1.55801    0.22175  -7.026 2.13e-12 ***
C2               -1.59504    0.10577 -15.081  &lt; 2e-16 ***
C3               -2.08142    0.17240 -12.073  &lt; 2e-16 ***
C4               -3.47861    0.26841 -12.960  &lt; 2e-16 ***
L2               -1.42666    0.10739 -13.285  &lt; 2e-16 ***
L3               -2.18148    0.17791 -12.262  &lt; 2e-16 ***
L4               -3.81133    0.27937 -13.643  &lt; 2e-16 ***
Rscore:Cscore     0.13353    0.02486   5.371 7.83e-08 ***
Mult(., R, C).   -0.66121    0.14008  -4.720 2.36e-06 ***
Mult(1, ., C).R1 -0.56136         NA      NA       NA    
Mult(1, ., C).R2  0.59333         NA      NA       NA    
Mult(1, ., C).R3  0.39165         NA      NA       NA    
Mult(1, ., C).R4 -0.42362         NA      NA       NA    
Mult(1, R, .).C1  0.15965         NA      NA       NA    
Mult(1, R, .).C2 -0.73633         NA      NA       NA    
Mult(1, R, .).C3 -0.07638         NA      NA       NA    
Mult(1, R, .).C4  0.65306         NA      NA       NA    
Rscore:Lscore     0.24848    0.02515   9.879  &lt; 2e-16 ***
Mult(., R, L).    1.13662    0.13964   8.140  &lt; 2e-16 ***
Mult(1, ., L).R1 -0.56136         NA      NA       NA    
Mult(1, ., L).R2  0.59333         NA      NA       NA    
Mult(1, ., L).R3  0.39165         NA      NA       NA    
Mult(1, ., L).R4 -0.42362         NA      NA       NA    
Mult(1, R, .).L1 -0.05054         NA      NA       NA    
Mult(1, R, .).L2  0.66157         NA      NA       NA    
Mult(1, R, .).L3  0.12640         NA      NA       NA    
Mult(1, R, .).L4 -0.73743         NA      NA       NA    
Cscore:Lscore     0.20270    0.02315   8.756  &lt; 2e-16 ***
Mult(., C, L).    0.28351    0.10068   2.816  0.00486 ** 
Mult(1, ., L).C1 -0.33661         NA      NA       NA    
Mult(1, ., L).C2 -0.08944         NA      NA       NA    
Mult(1, ., L).C3  0.84069         NA      NA       NA    
Mult(1, ., L).C4 -0.41464         NA      NA       NA    
Mult(1, C, .).L1 -0.08991         NA      NA       NA    
Mult(1, C, .).L2 -0.62111         NA      NA       NA    
Mult(1, C, .).L3  0.77584         NA      NA       NA    
Mult(1, C, .).L4 -0.06482         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 47.134 on 48 degrees of freedom
AIC: 373.45

Number of iterations: 3</code></pre>
<pre><code>                       Estimate Std. Error
Mult(1, ., C + L).R1 -0.5613577 0.07946201
Mult(1, ., C + L).R2  0.5933253 0.06976100
Mult(1, ., C + L).R3  0.3916506 0.08375491
Mult(1, ., C + L).R4 -0.4236182 0.08896023</code></pre>
<pre><code>                    Estimate Std. Error
Mult(1, R, .).C1  0.15964986 0.14637516
Mult(1, R, .).C2 -0.73633460 0.08871449
Mult(1, R, .).C3 -0.07637713 0.15684115
Mult(1, R, .).C4  0.65306187 0.10868144</code></pre>
<pre><code>                    Estimate Std. Error
Mult(1, R, .).L1 -0.05053742 0.08981862
Mult(1, R, .).L2  0.66156822 0.06038098
Mult(1, R, .).L3  0.12639555 0.08679365
Mult(1, R, .).L4 -0.73742635 0.04940126</code></pre>
<pre><code>                    Estimate Std. Error
Mult(1, ., L).C1 -0.33661004 0.30087703
Mult(1, ., L).C2 -0.08944163 0.36058729
Mult(1, ., L).C3  0.84069369 0.08936905
Mult(1, ., L).C4 -0.41464201 0.32252708</code></pre>
<pre><code>                    Estimate Std. Error
Mult(1, C, .).L1 -0.08990831  0.3610226
Mult(1, C, .).L2 -0.62111332  0.2399524
Mult(1, C, .).L3  0.77584334  0.1519881
Mult(1, C, .).L4 -0.06482171  0.3227342</code></pre>
<pre><code># A tibble: 1 x 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model9                 38  47.1 -231.  6.25 0.853</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="4-Chapter_3.html#cb55-1"></a><span class="co"># Model 10 - Model 8 with consistent col scores</span></span>
<span id="cb55-2"><a href="4-Chapter_3.html#cb55-2"></a>model10 &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,C,R<span class="op">+</span>L)<span class="op">+</span></span>
<span id="cb55-3"><a href="4-Chapter_3.html#cb55-3"></a><span class="st">               </span>Rscore<span class="op">:</span>Lscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,L)<span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>Lscore,</span>
<span id="cb55-4"><a href="4-Chapter_3.html#cb55-4"></a>               <span class="dt">data =</span> ., </span>
<span id="cb55-5"><a href="4-Chapter_3.html#cb55-5"></a>               <span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................................................
..........................................................................................
............................................................
Done</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="4-Chapter_3.html#cb57-1"></a><span class="kw">model.summary</span>(model10)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model10                38  54.8 -223.  7.50 0.962</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="4-Chapter_3.html#cb59-1"></a><span class="co"># Model 11 - Model 8 with consistent layer scores</span></span>
<span id="cb59-2"><a href="4-Chapter_3.html#cb59-2"></a>model11&lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,L,R<span class="op">+</span>C)<span class="op">+</span></span>
<span id="cb59-3"><a href="4-Chapter_3.html#cb59-3"></a><span class="st">               </span>Rscore<span class="op">:</span>Lscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C)<span class="op">+</span><span class="st"> </span>Cscore<span class="op">:</span>Lscore,</span>
<span id="cb59-4"><a href="4-Chapter_3.html#cb59-4"></a>               <span class="dt">data =</span> .,</span>
<span id="cb59-5"><a href="4-Chapter_3.html#cb59-5"></a>               <span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................................................
.............
Done</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="4-Chapter_3.html#cb61-1"></a><span class="kw">model.summary</span>(model11)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model11                38  53.6 -225.  6.58 0.952</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="4-Chapter_3.html#cb63-1"></a><span class="co"># Model 12 - Modek 9 + U(RL)=U(CL)</span></span>
<span id="cb63-2"><a href="4-Chapter_3.html#cb63-2"></a><span class="co"># To impose equality constraint on U(RL) &amp; U(CL),</span></span>
<span id="cb63-3"><a href="4-Chapter_3.html#cb63-3"></a><span class="co"># a covariate is created in following manner:</span></span>
<span id="cb63-4"><a href="4-Chapter_3.html#cb63-4"></a></span>
<span id="cb63-5"><a href="4-Chapter_3.html#cb63-5"></a></span>
<span id="cb63-6"><a href="4-Chapter_3.html#cb63-6"></a>freq_tab_<span class="fl">3.1</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">cov_rcl =</span> Rscore<span class="op">*</span>Lscore<span class="op">+</span>Cscore<span class="op">*</span>Lscore)</span>
<span id="cb63-7"><a href="4-Chapter_3.html#cb63-7"></a>model12&lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C<span class="op">+</span>L)<span class="op">+</span></span>
<span id="cb63-8"><a href="4-Chapter_3.html#cb63-8"></a><span class="st">               </span>cov_rcl<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,C,L),</span>
<span id="cb63-9"><a href="4-Chapter_3.html#cb63-9"></a>               <span class="dt">data =</span>.,<span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................................................
................
Done</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="4-Chapter_3.html#cb65-1"></a><span class="co">#summary(model12)</span></span>
<span id="cb65-2"><a href="4-Chapter_3.html#cb65-2"></a><span class="kw">model.summary</span>(model12)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model12                39  48.6 -237.  6.57 0.860</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="4-Chapter_3.html#cb67-1"></a>mu&lt;-<span class="kw">getContrasts</span>(model12, <span class="kw">pickCoef</span>(model12, <span class="st">&quot;[.]R&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb67-2"><a href="4-Chapter_3.html#cb67-2"></a>                 <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb67-3"><a href="4-Chapter_3.html#cb67-3"></a></span>
<span id="cb67-4"><a href="4-Chapter_3.html#cb67-4"></a>nu2&lt;-<span class="kw">getContrasts</span>(model12, <span class="kw">pickCoef</span>(model12, <span class="st">&quot;[.]C&quot;</span>)[<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>], <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb67-5"><a href="4-Chapter_3.html#cb67-5"></a>                  <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb67-6"><a href="4-Chapter_3.html#cb67-6"></a></span>
<span id="cb67-7"><a href="4-Chapter_3.html#cb67-7"></a>eta2&lt;-<span class="kw">getContrasts</span>(model12, <span class="kw">pickCoef</span>(model12, <span class="st">&quot;[.]L&quot;</span>)[<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>], <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb67-8"><a href="4-Chapter_3.html#cb67-8"></a>                   <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb67-9"><a href="4-Chapter_3.html#cb67-9"></a></span>
<span id="cb67-10"><a href="4-Chapter_3.html#cb67-10"></a>model12.extended &lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C)<span class="op">+</span></span>
<span id="cb67-11"><a href="4-Chapter_3.html#cb67-11"></a><span class="st">                        </span>cov_rcl<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,L)<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,C,L),</span>
<span id="cb67-12"><a href="4-Chapter_3.html#cb67-12"></a>                      <span class="dt">constrain=</span><span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">16</span>,<span class="dv">23</span><span class="op">:</span><span class="dv">26</span>),<span class="dt">constrainTo=</span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>],mu<span class="op">$</span>qvframe[,<span class="dv">1</span>]),</span>
<span id="cb67-13"><a href="4-Chapter_3.html#cb67-13"></a>                      <span class="dt">data =</span> .,</span>
<span id="cb67-14"><a href="4-Chapter_3.html#cb67-14"></a>                      <span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...................................................................
.............................
Done</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="4-Chapter_3.html#cb69-1"></a><span class="kw">summary</span>(model12.extended)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L) + Mult(1, C, L), constrain = c(13:16, 
    23:26), constrainTo = c(mu$qvframe[, 1], mu$qvframe[, 1]), 
    family = poisson, data = ., tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.58844  -0.76809   0.02278   0.56330   1.92999  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.58449         NA      NA       NA    
R2               -1.00051         NA      NA       NA    
R3               -0.70053         NA      NA       NA    
R4               -1.39883         NA      NA       NA    
C2               -1.63242         NA      NA       NA    
C3               -2.13996         NA      NA       NA    
C4               -3.65896         NA      NA       NA    
L2               -1.36583         NA      NA       NA    
L3               -2.16676         NA      NA       NA    
L4               -3.74210         NA      NA       NA    
Rscore:Cscore     0.13336    0.02542   5.246 1.55e-07 ***
Mult(., R, C).   -0.80657         NA      NA       NA    
Mult(1, ., C).R1  0.53827         NA      NA       NA    
Mult(1, ., C).R2 -0.59767         NA      NA       NA    
Mult(1, ., C).R3 -0.38941         NA      NA       NA    
Mult(1, ., C).R4  0.44880         NA      NA       NA    
Mult(1, R, .).C1 -0.12707         NA      NA       NA    
Mult(1, R, .).C2  0.60502         NA      NA       NA    
Mult(1, R, .).C3  0.08064         NA      NA       NA    
Mult(1, R, .).C4 -0.49208         NA      NA       NA    
cov_rcl           0.22423    0.01709  13.123  &lt; 2e-16 ***
Mult(., R, L).    0.90628         NA      NA       NA    
Mult(1, ., L).R1  0.53827         NA      NA       NA    
Mult(1, ., L).R2 -0.59767         NA      NA       NA    
Mult(1, ., L).R3 -0.38941         NA      NA       NA    
Mult(1, ., L).R4  0.44880         NA      NA       NA    
Mult(1, R, .).L1  0.00258         NA      NA       NA    
Mult(1, R, .).L2 -0.88692         NA      NA       NA    
Mult(1, R, .).L3 -0.20816         NA      NA       NA    
Mult(1, R, .).L4  0.87418         NA      NA       NA    
Mult(., C, L).    0.80133         NA      NA       NA    
Mult(1, ., L).C1  0.06908         NA      NA       NA    
Mult(1, ., L).C2 -0.01996         NA      NA       NA    
Mult(1, ., L).C3 -0.65631         NA      NA       NA    
Mult(1, ., L).C4  0.16741         NA      NA       NA    
Mult(1, C, .).L1  0.06092         NA      NA       NA    
Mult(1, C, .).L2  0.41886         NA      NA       NA    
Mult(1, C, .).L3 -0.33023         NA      NA       NA    
Mult(1, C, .).L4  0.13138         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 48.569 on 41 degrees of freedom
AIC: 388.89

Number of iterations: 96</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="4-Chapter_3.html#cb71-1"></a>nu1&lt;-<span class="kw">getContrasts</span>(model12.extended,</span>
<span id="cb71-2"><a href="4-Chapter_3.html#cb71-2"></a>                  <span class="kw">pickCoef</span>(model12.extended, <span class="st">&quot;[.]C&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb71-3"><a href="4-Chapter_3.html#cb71-3"></a>                  <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb71-4"><a href="4-Chapter_3.html#cb71-4"></a></span>
<span id="cb71-5"><a href="4-Chapter_3.html#cb71-5"></a>eta1&lt;-<span class="kw">getContrasts</span>(model12.extended, <span class="kw">pickCoef</span>(model12.extended, <span class="st">&quot;[.]L&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],</span>
<span id="cb71-6"><a href="4-Chapter_3.html#cb71-6"></a>                   <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,<span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb71-7"><a href="4-Chapter_3.html#cb71-7"></a></span>
<span id="cb71-8"><a href="4-Chapter_3.html#cb71-8"></a>model12.phis&lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C)<span class="op">+</span></span>
<span id="cb71-9"><a href="4-Chapter_3.html#cb71-9"></a><span class="st">                    </span>cov_rcl<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,L)<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,C,L),</span>
<span id="cb71-10"><a href="4-Chapter_3.html#cb71-10"></a>                  <span class="dt">constrain=</span><span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">23</span><span class="op">:</span><span class="dv">30</span>,<span class="dv">32</span><span class="op">:</span><span class="dv">39</span>),<span class="dt">constrainTo=</span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>],nu1<span class="op">$</span>qvframe[,<span class="dv">1</span>],</span>
<span id="cb71-11"><a href="4-Chapter_3.html#cb71-11"></a>                                                               mu<span class="op">$</span>qvframe[,<span class="dv">1</span>],eta1<span class="op">$</span>qvframe[,<span class="dv">1</span>],nu2<span class="op">$</span>qvframe[,<span class="dv">1</span>],eta2<span class="op">$</span>qvframe[,<span class="dv">1</span>]),</span>
<span id="cb71-12"><a href="4-Chapter_3.html#cb71-12"></a>                  <span class="dt">data =</span> .,</span>
<span id="cb71-13"><a href="4-Chapter_3.html#cb71-13"></a>                  <span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="4-Chapter_3.html#cb73-1"></a><span class="kw">summary</span>(model12.phis);mu;nu1;eta1;nu2;eta2;<span class="kw">model.summary</span>(model12)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L) + Mult(1, C, L), constrain = c(13:20, 
    23:30, 32:39), constrainTo = c(mu$qvframe[, 1], nu1$qvframe[, 
    1], mu$qvframe[, 1], eta1$qvframe[, 1], nu2$qvframe[, 1], 
    eta2$qvframe[, 1]), family = poisson, data = ., tolerance = 1e-12,     trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.58844  -0.76809   0.02278   0.56330   1.92999  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.55535    0.08106  43.859  &lt; 2e-16 ***
R2               -0.92909    0.11339  -8.194  &lt; 2e-16 ***
R3               -0.64221    0.12609  -5.093 3.52e-07 ***
R4               -1.39320    0.17746  -7.851  &lt; 2e-16 ***
C2               -1.63743    0.10043 -16.304  &lt; 2e-16 ***
C3               -2.18079    0.15608 -13.973  &lt; 2e-16 ***
C4               -3.65343    0.23846 -15.321  &lt; 2e-16 ***
L2               -1.39736    0.10537 -13.261  &lt; 2e-16 ***
L3               -2.13230    0.17235 -12.372  &lt; 2e-16 ***
L4               -3.74831    0.27154 -13.804  &lt; 2e-16 ***
Rscore:Cscore     0.13336    0.02490   5.357 8.48e-08 ***
Mult(., R, C).   -0.64007    0.13725  -4.663 3.11e-06 ***
Mult(1, ., C).R1  0.53827         NA      NA       NA    
Mult(1, ., C).R2 -0.59766         NA      NA       NA    
Mult(1, ., C).R3 -0.38941         NA      NA       NA    
Mult(1, ., C).R4  0.44880         NA      NA       NA    
Mult(1, R, .).C1 -0.18108         NA      NA       NA    
Mult(1, R, .).C2  0.74146         NA      NA       NA    
Mult(1, R, .).C3  0.08067         NA      NA       NA    
Mult(1, R, .).C4 -0.64105         NA      NA       NA    
cov_rcl           0.22423    0.01636  13.707  &lt; 2e-16 ***
Mult(., R, L).    1.13998    0.13669   8.340  &lt; 2e-16 ***
Mult(1, ., L).R1  0.53827         NA      NA       NA    
Mult(1, ., L).R2 -0.59766         NA      NA       NA    
Mult(1, ., L).R3 -0.38941         NA      NA       NA    
Mult(1, ., L).R4  0.44880         NA      NA       NA    
Mult(1, R, .).L1  0.04544         NA      NA       NA    
Mult(1, R, .).L2 -0.66170         NA      NA       NA    
Mult(1, R, .).L3 -0.12210         NA      NA       NA    
Mult(1, R, .).L4  0.73836         NA      NA       NA    
Mult(., C, L).   -0.27613    0.10158  -2.718  0.00656 ** 
Mult(1, ., L).C1 -0.27770         NA      NA       NA    
Mult(1, ., L).C2 -0.13959         NA      NA       NA    
Mult(1, ., L).C3  0.84752         NA      NA       NA    
Mult(1, ., L).C4 -0.43024         NA      NA       NA    
Mult(1, C, .).L1 -0.01743         NA      NA       NA    
Mult(1, C, .).L2  0.65220         NA      NA       NA    
Mult(1, C, .).L3 -0.74916         NA      NA       NA    
Mult(1, C, .).L4  0.11439         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 48.569 on 49 degrees of freedom
AIC: 372.89

Number of iterations: 3</code></pre>
<pre><code>                       Estimate Std. Error
Mult(1, ., C + L).R1  0.5382715 0.07940991
Mult(1, ., C + L).R2 -0.5976649 0.06869502
Mult(1, ., C + L).R3 -0.3894076 0.08390695
Mult(1, ., C + L).R4  0.4488010 0.08495489</code></pre>
<pre><code>                    Estimate Std. Error
Mult(1, R, .).C1 -0.18108336  0.1505749
Mult(1, R, .).C2  0.74145909  0.0888159
Mult(1, R, .).C3  0.08066998  0.1598862
Mult(1, R, .).C4 -0.64104571  0.1141041</code></pre>
<pre><code>                   Estimate Std. Error
Mult(1, R, .).L1  0.0454423 0.08895571
Mult(1, R, .).L2 -0.6617033 0.05943373
Mult(1, R, .).L3 -0.1220991 0.08507409
Mult(1, R, .).L4  0.7383601 0.04862532</code></pre>
<pre><code>                   Estimate Std. Error
Mult(1, ., L).C1 -0.2776974 0.30818568
Mult(1, ., L).C2 -0.1395889 0.36977790
Mult(1, ., L).C3  0.8475231 0.08001496
Mult(1, ., L).C4 -0.4302368 0.32326672</code></pre>
<pre><code>                    Estimate Std. Error
Mult(1, C, .).L1 -0.01742597  0.3681779
Mult(1, C, .).L2  0.65219849  0.2296758
Mult(1, C, .).L3 -0.74916478  0.1797929
Mult(1, C, .).L4  0.11439226  0.3321123</code></pre>
<pre><code># A tibble: 1 x 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model12                39  48.6 -237.  6.57 0.860</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="4-Chapter_3.html#cb81-1"></a><span class="co"># Model 15</span></span>
<span id="cb81-2"><a href="4-Chapter_3.html#cb81-2"></a></span>
<span id="cb81-3"><a href="4-Chapter_3.html#cb81-3"></a>freq_tab_<span class="fl">3.1</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">cov_rcl =</span> Rscore<span class="op">*</span>Lscore<span class="op">+</span>Cscore<span class="op">*</span>Lscore)</span>
<span id="cb81-4"><a href="4-Chapter_3.html#cb81-4"></a>model15&lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb81-5"><a href="4-Chapter_3.html#cb81-5"></a><span class="st">  </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C<span class="op">+</span>L)<span class="op">+</span>cov_rcl,</span>
<span id="cb81-6"><a href="4-Chapter_3.html#cb81-6"></a>      <span class="dt">data =</span> .,</span>
<span id="cb81-7"><a href="4-Chapter_3.html#cb81-7"></a>      ,<span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations.................................................
Done</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="4-Chapter_3.html#cb83-1"></a><span class="kw">summary</span>(model15)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C + 
    L) + cov_rcl, family = poisson, data = ., tolerance = 1e-12,     trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.98677  -0.75501   0.01756   0.52206   2.97799  

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           3.57316         NA      NA       NA    
R2                   -0.96403         NA      NA       NA    
R3                   -0.68081         NA      NA       NA    
R4                   -1.42280         NA      NA       NA    
C2                   -1.67264         NA      NA       NA    
C3                   -2.17739         NA      NA       NA    
C4                   -3.68263         NA      NA       NA    
L2                   -1.44956         NA      NA       NA    
L3                   -2.16749         NA      NA       NA    
L4                   -3.78598         NA      NA       NA    
Rscore:Cscore         0.13307    0.02552   5.215 1.84e-07 ***
Mult(., R, C + L).    0.42235         NA      NA       NA    
Mult(1, ., C + L).R1  0.79131         NA      NA       NA    
Mult(1, ., C + L).R2 -1.01157         NA      NA       NA    
Mult(1, ., C + L).R3 -0.68058         NA      NA       NA    
Mult(1, ., C + L).R4  0.63184         NA      NA       NA    
Mult(1, R, . + L).C1  0.21278         NA      NA       NA    
Mult(1, R, . + L).C2 -0.66899         NA      NA       NA    
Mult(1, R, . + L).C3 -0.01786         NA      NA       NA    
Mult(1, R, . + L).C4  0.66458         NA      NA       NA    
Mult(1, R, C + .).L2 -1.20506         NA      NA       NA    
Mult(1, R, C + .).L3 -0.30408         NA      NA       NA    
Mult(1, R, C + .).L4  1.18104         NA      NA       NA    
cov_rcl               0.22862    0.01709  13.377  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 55.984 on 44 degrees of freedom
AIC: 390.3

Number of iterations: 49</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="4-Chapter_3.html#cb85-1"></a><span class="kw">model.summary</span>(model15)</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model15                44  56.0 -266.  6.83 0.894</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="4-Chapter_3.html#cb87-1"></a>mu&lt;-<span class="kw">getContrasts</span>(model15, <span class="kw">pickCoef</span>(model15, <span class="st">&quot;[.]R&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb87-2"><a href="4-Chapter_3.html#cb87-2"></a>                 <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb87-3"><a href="4-Chapter_3.html#cb87-3"></a></span>
<span id="cb87-4"><a href="4-Chapter_3.html#cb87-4"></a>nu&lt;-<span class="kw">getContrasts</span>(model15, <span class="kw">pickCoef</span>(model15, <span class="st">&quot;[.]C&quot;</span>), <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb87-5"><a href="4-Chapter_3.html#cb87-5"></a>                 <span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb87-6"><a href="4-Chapter_3.html#cb87-6"></a></span>
<span id="cb87-7"><a href="4-Chapter_3.html#cb87-7"></a>model15.extended&lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C)<span class="op">+</span></span>
<span id="cb87-8"><a href="4-Chapter_3.html#cb87-8"></a><span class="st">                        </span>cov_rcl<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,L),<span class="dt">constrain=</span><span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">16</span>,<span class="dv">23</span><span class="op">:</span><span class="dv">26</span>),</span>
<span id="cb87-9"><a href="4-Chapter_3.html#cb87-9"></a>                      <span class="dt">constrainTo=</span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>],mu<span class="op">$</span>qvframe[,<span class="dv">1</span>]),</span>
<span id="cb87-10"><a href="4-Chapter_3.html#cb87-10"></a>                      <span class="dt">data =</span> .,</span>
<span id="cb87-11"><a href="4-Chapter_3.html#cb87-11"></a>                      <span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations....
Done</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="4-Chapter_3.html#cb89-1"></a><span class="kw">summary</span>(model15.extended)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L), constrain = c(13:16, 23:26), constrainTo = c(mu$qvframe[, 
    1], mu$qvframe[, 1]), family = poisson, data = ., tolerance = 1e-12,     trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.98677  -0.75501   0.01756   0.52206   2.97799  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.59119         NA      NA       NA    
R2               -1.01458         NA      NA       NA    
R3               -0.72208         NA      NA       NA    
R4               -1.42727         NA      NA       NA    
C2               -1.64759    0.10152  -16.23  &lt; 2e-16 ***
C3               -2.17084    0.15843  -13.70  &lt; 2e-16 ***
C4               -3.69546    0.24129  -15.32  &lt; 2e-16 ***
L2               -1.41533    0.10612  -13.34  &lt; 2e-16 ***
L3               -2.15885    0.17266  -12.50  &lt; 2e-16 ***
L4               -3.81953    0.27268  -14.01  &lt; 2e-16 ***
Rscore:Cscore     0.13307    0.02539    5.24  1.6e-07 ***
Mult(., R, C).   -1.01712         NA      NA       NA    
Mult(1, ., C).R1  0.54368         NA      NA       NA    
Mult(1, ., C).R2 -0.59799         NA      NA       NA    
Mult(1, ., C).R3 -0.38839         NA      NA       NA    
Mult(1, ., C).R4  0.44270         NA      NA       NA    
Mult(1, R, .).C1 -0.07188         NA      NA       NA    
Mult(1, R, .).C2  0.50633         NA      NA       NA    
Mult(1, R, .).C3  0.07936         NA      NA       NA    
Mult(1, R, .).C4 -0.36814         NA      NA       NA    
cov_rcl           0.22862    0.01643   13.91  &lt; 2e-16 ***
Mult(., R, L).    0.42369         NA      NA       NA    
Mult(1, ., L).R1  0.54368         NA      NA       NA    
Mult(1, ., L).R2 -0.59799         NA      NA       NA    
Mult(1, ., L).R3 -0.38839         NA      NA       NA    
Mult(1, ., L).R4  0.44270         NA      NA       NA    
Mult(1, R, .).L1  0.05789         NA      NA       NA    
Mult(1, R, .).L2 -1.83911         NA      NA       NA    
Mult(1, R, .).L3 -0.42080         NA      NA       NA    
Mult(1, R, .).L4  1.91708         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 55.984 on 46 degrees of freedom
AIC: 386.3

Number of iterations: 4</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="4-Chapter_3.html#cb91-1"></a>eta&lt;-<span class="kw">getContrasts</span>(model15.extended, <span class="kw">pickCoef</span>(model15.extended, <span class="st">&quot;[.]L&quot;</span>),</span>
<span id="cb91-2"><a href="4-Chapter_3.html#cb91-2"></a>                  <span class="dt">ref =</span> <span class="st">&quot;mean&quot;</span>,<span class="dt">scaleRef =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">scaleWeights =</span> <span class="st">&quot;unit&quot;</span>)</span>
<span id="cb91-3"><a href="4-Chapter_3.html#cb91-3"></a></span>
<span id="cb91-4"><a href="4-Chapter_3.html#cb91-4"></a>model15.phis&lt;-<span class="st"> </span>freq_tab_<span class="fl">3.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gnm</span>(Freq<span class="op">~</span>R<span class="op">+</span>C<span class="op">+</span>L<span class="op">+</span>Rscore<span class="op">:</span>Cscore<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,C)<span class="op">+</span>cov_rcl<span class="op">+</span><span class="kw">Mult</span>(<span class="dv">1</span>,R,L),</span>
<span id="cb91-5"><a href="4-Chapter_3.html#cb91-5"></a>                  <span class="dt">constrain=</span><span class="kw">c</span>(<span class="dv">13</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">23</span><span class="op">:</span><span class="dv">30</span>),</span>
<span id="cb91-6"><a href="4-Chapter_3.html#cb91-6"></a>                  <span class="dt">constrainTo=</span><span class="kw">c</span>(mu<span class="op">$</span>qvframe[,<span class="dv">1</span>],nu<span class="op">$</span>qvframe[,<span class="dv">1</span>],mu<span class="op">$</span>qvframe[,<span class="dv">1</span>],eta<span class="op">$</span>qvframe[,<span class="dv">1</span>]),</span>
<span id="cb91-7"><a href="4-Chapter_3.html#cb91-7"></a>                  <span class="dt">data =</span> .,</span>
<span id="cb91-8"><a href="4-Chapter_3.html#cb91-8"></a>                  <span class="dt">family =</span> poisson,<span class="dt">trace =</span> F,<span class="dt">tolerance =</span> <span class="fl">1e-12</span>)</span></code></pre></div>
<pre><code>Initialising
Running start-up iterations..
Running main iterations...
Done</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="4-Chapter_3.html#cb93-1"></a><span class="kw">summary</span>(model15.phis);mu;nu;eta;<span class="kw">model.summary</span>(model15)</span></code></pre></div>
<pre><code>
Call:
gnm(formula = Freq ~ R + C + L + Rscore:Cscore + Mult(1, R, C) + 
    cov_rcl + Mult(1, R, L), constrain = c(13:20, 23:30), constrainTo = c(mu$qvframe[, 
    1], nu$qvframe[, 1], mu$qvframe[, 1], eta$qvframe[, 1]), 
    family = poisson, data = ., tolerance = 1e-12, trace = F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.98677  -0.75501   0.01756   0.52206   2.97799  

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       3.55464    0.08091  43.935  &lt; 2e-16 ***
R2               -0.93784    0.11339  -8.271  &lt; 2e-16 ***
R3               -0.65943    0.12613  -5.228 1.71e-07 ***
R4               -1.42048    0.17754  -8.001  &lt; 2e-16 ***
C2               -1.64759    0.10044 -16.404  &lt; 2e-16 ***
C3               -2.17084    0.15588 -13.927  &lt; 2e-16 ***
C4               -3.69546    0.23861 -15.488  &lt; 2e-16 ***
L2               -1.41533    0.10551 -13.414  &lt; 2e-16 ***
L3               -2.15885    0.17245 -12.519  &lt; 2e-16 ***
L4               -3.81953    0.27221 -14.032  &lt; 2e-16 ***
Rscore:Cscore     0.13307    0.02492   5.341 9.24e-08 ***
Mult(., R, C).    0.64172    0.13829   4.641 3.48e-06 ***
Mult(1, ., C).R1  0.54368         NA      NA       NA    
Mult(1, ., C).R2 -0.59799         NA      NA       NA    
Mult(1, ., C).R3 -0.38839         NA      NA       NA    
Mult(1, ., C).R4  0.44270         NA      NA       NA    
Mult(1, R, .).C1  0.17165         NA      NA       NA    
Mult(1, R, .).C2 -0.74481         NA      NA       NA    
Mult(1, R, .).C3 -0.06806         NA      NA       NA    
Mult(1, R, .).C4  0.64122         NA      NA       NA    
cov_rcl           0.22862    0.01640  13.939  &lt; 2e-16 ***
Mult(., R, L).    1.13826    0.13726   8.293  &lt; 2e-16 ***
Mult(1, ., L).R1  0.54368         NA      NA       NA    
Mult(1, ., L).R2 -0.59799         NA      NA       NA    
Mult(1, ., L).R3 -0.38839         NA      NA       NA    
Mult(1, ., L).R4  0.44270         NA      NA       NA    
Mult(1, R, .).L1  0.04806         NA      NA       NA    
Mult(1, R, .).L2 -0.65804         NA      NA       NA    
Mult(1, R, .).L3 -0.13012         NA      NA       NA    
Mult(1, R, .).L4  0.74010         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

Std. Error is NA where coefficient has been constrained or is unidentified

Residual deviance: 55.984 on 50 degrees of freedom
AIC: 378.3

Number of iterations: 3</code></pre>
<pre><code>                       Estimate Std. Error
Mult(1, ., C + L).R1  0.5436794 0.07818382
Mult(1, ., C + L).R2 -0.5979869 0.06871974
Mult(1, ., C + L).R3 -0.3883879 0.08391754
Mult(1, ., C + L).R4  0.4426954 0.08454001</code></pre>
<pre><code>                        Estimate Std. Error
Mult(1, R, . + L).C1  0.17164747 0.14998137
Mult(1, R, . + L).C2 -0.74480785 0.08583798
Mult(1, R, . + L).C3 -0.06806188 0.15421719
Mult(1, R, . + L).C4  0.64122226 0.11322236</code></pre>
<pre><code>                    Estimate Std. Error
Mult(1, R, .).L1  0.04806244 0.08932196
Mult(1, R, .).L2 -0.65804171 0.05969167
Mult(1, R, .).L3 -0.13011596 0.08427834
Mult(1, R, .).L4  0.74009523 0.04837401</code></pre>
<pre><code># A tibble: 1 x 6
  `Model Description`    df    L2   BIC Delta     p
  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 model15                44  56.0 -266.  6.83 0.894</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="3-Chapter_2.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["カテゴリカルデータの連関モデル.pdf", "カテゴリカルデータの連関モデル.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
